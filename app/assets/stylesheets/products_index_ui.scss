/* Лейаут: слева сайдбар (десктоп), справа контент */
.products-layout {
  display: block;
}

@media (min-width: 992px) {
  .products-layout {
    display: grid;
    grid-template-columns: clamp(220px, 18vw, 280px) 1fr;
    gap: 1rem;
  }
}

/* Сайдбар с пилюлями (десктоп): фиксируем под баннером */
.products-sidebar {
  display: none;
}

@media (min-width: 992px) {
  .products-sidebar {
    display: block;
    position: sticky;
    top: calc(var(--navbar-offset) + 8px);
    align-self: start;
    max-height: calc(100vh - var(--navbar-offset) - 16px);
    overflow: auto;
    padding: .5rem .5rem 1rem;
    border: 1px solid #e9ecef;
    border-radius: .5rem;
    background: #fff;
  }

  .products-sidebar .pill {
    display: block;
    text-align: left;
  }
}

/* Поисковая карточка: не прилипает к баннеру,
   но фиксируется на месте со ЗАЗОРОМ (и на мобиле тоже) */
.products-search-sticky {
  /* вместо @extend .sticky-below-banner — прописываем явно */
  position: sticky;
  top: calc(var(--navbar-offset) + var(--banner-height) + 8px);
  z-index: 1029;
  background: #fff;

  margin: .25rem 0 1rem;
  box-shadow: 0 2px 6px rgba(0,0,0,.04);
  border-radius: .5rem;
}

/* Пространство внутри карточки поиска — и сверху и снизу, особенно на мобиле */
.products-search-sticky .card-body {
  padding-top: .75rem;
  padding-bottom: .75rem;
}

/* Карточки семейств: аккуратные отступы и якоря */
.products-family-card {
  margin-bottom: 1rem;
}

.products-family-card .card-header {
  font-weight: 500;
}

.products-family-card {
  /* чтобы скролл к якорю не уезжал под фикс-панели */
  scroll-margin-top: calc(var(--navbar-offset) + var(--banner-height) + 16px);
}

/* Offcanvas-навигация пилюлями (мобилка): выезжает как “жалюзи”
   из-под панельки, на половину экрана */
#productsFamiliesNav.offcanvas-top {
  top: calc(var(--navbar-offset) + var(--banner-height));
  /* раньше было: height: min(50vh, 380px); из-за sassc падало на разных единицах */
  height: 50vh;
  max-height: 380px;
  border-bottom-left-radius: .75rem;
  border-bottom-right-radius: .75rem;
  box-shadow: 0 8px 20px rgba(0,0,0,.12);
}

#productsFamiliesNav .offcanvas-body {
  padding: 1rem .75rem;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

#productsFamiliesNav .pill {
  margin: .25rem .35rem .35rem 0;
}


/* ===== Sticky search on /products ===== */

/* дефолтные переменные — всё в px, чтобы не смешивать px и vh */
:root {
  --nav-h: 56px;       /* реальная высота навбара придёт из JS */
  --banner-h: 0px;     /* если баннер фикс/стик, JS подставит высоту */
  --gap-sm: 8px;       /* маленькие отступы сверху/снизу — как просили */
  --gap-lg: 6px;
  --sticky-top-mobile: calc(var(--nav-h) + var(--banner-h) + var(--gap-sm));
  --sticky-top-desktop: calc(var(--nav-h) + var(--gap-lg)); /* «приподнять» на десктопе */
}

/* сам контейнер: позиция sticky + небольшой отступ сверху/снизу */
.products-search-wrap {
  position: sticky;
  top: var(--sticky-top-mobile);
  z-index: 1029;               /* ниже .navbar (Bootstrap ~1030), выше контента */
  margin-top: var(--gap-sm);
  margin-bottom: var(--gap-sm);
  background: var(--bs-body-bg); /* чтобы не просвечивал фон при прилипании */
}

/* на десктопе приподнимаем (т.е. ближе к шапке) и немного уменьшаем зазор */
@media (min-width: 992px) {
  .products-search-wrap {
    top: var(--sticky-top-desktop);
    margin-top: var(--gap-lg);
    margin-bottom: var(--gap-lg);
  }
}

/* опционально: если карточка слишком «толстая» на мобиле — сделаем её компактнее */
@media (max-width: 991.98px) {
  .products-search-wrap .card-body {
    padding: .5rem .75rem;
  }
}
